# Подготовка

Для выполнения данной ЛР я использовал машину созданную в предыдущей работе. 
Далее, в новой машине прописываем команды `git clone <URL-репозитория>` и `sudo apt-get install git-flow` (на будущее).

# Введение

Создадим файл example.txt и запишем туда _какой-нибудь текст_ и с помощью команд:

```
git add example.txt
git commit -m "File added example.txt"
git push origin main
```

запушим его. 

Далее перейдём к работе с ветками. С помощью команд 

```
git branch feature-branch
git checkout feature-branch
```

создадим веткуfeature-branch и переключемся на неё. Теперь дополним example.txt и повторно введём вышеуказаные команды(но меняем имя комита на `"New file added example.txt"`). Таким образом пушим example.txt на текущую ветку и получаем следущее:

![image](https://github.com/cs-itmo-2023/lab-5-Nirolok/assets/40453222/69877899-b23a-495b-903f-ad5a399382ef)

После данной операции, с помощью команды `git checkout main` возвращаемся к  основной ветке и с помощью команд `git merge feature-branch` и `git push origin main` сливаем изменения из ветки feature-branch в main. Так у нас получаются две ветки и изменения в обоих ветках.

# Работа с ветками

Создаём README.md файл, в котором создаём базовую структуру книги и комитим его в main

*вставить скрин комита readme в main*

Далее создаём и переходим в ветку feature-login, с помощью команды `git checkout -b feature-login`.
В README вносим изменения (добавляем третью главу) и комитим его на feature-login.

*скриншот коммита*

# Работа с удалённым репозиторием

Возвращаемся на ветку main, вносим в файл изменения и соответсвенно комитим

*скрин комита*

# Моделирование конфликта

Переходим на ветку feature-login, изменяем файл и комитим 

*ну собственно скрин комита*

# Разрешение конфликта

С помощью команд

```
git checkout main
git pull origin main
```
прыгаем на ветку main и пытаемся слить изменения, но ловим конфликт

*скрин конфликта*

Переходим в файл и удаляем всё лишнее

*было*
*стало*

Комитим решение конфликта 

*скрин комита*

# Автоматизация проверки файлов при коммите

Переходим в .git/hooks (предварительно ставим галочку на "показывать скрытые файлы") и создаём там файл с названием pre-commit(ему необходимо дать право на выполнение).
В данном файле мы напишем скрипт, который будет проверять файлы на наличие "ключа" (ну или просто наличия "===" в файле).
Что делает скрипт:
Проверяет файл на наличие "===". В случае если "ключ" не найден выводим "<filename> is okay", иначе "<filename> is not okay" и завершаем скрипт с кодом 1. Данный скрипт применяется ко всем переданным файлам, и если все проходят проверку выводи "Everything is okay", завершаем скрипт с кодом 0.

*код и пример работы*

# Использование Git Flow в проекте 

Перед тем как начать работать с git flow необхлдимо ~~трижды перекриститься~~~ установить git flow на локальную машину, что мы сделали ещё в самом начале.

Для нормальной работы git flow нам нужно создать ветку develop (по аналогии с предыдущими), после чего можно инициализировать git flow с помощью команды `git flow init`.

Затем, командой `git flow feature start task-management` фетку новой функциональности. В ней создаём файл task_manager.py, в который вставляем код

~~~
def create_task(title, description):
    # Логика создания задачи
    print(f"Создана новая задача: {title}")
~~~

И соответсвенно комитим файл

~~~
git add task_manager.py
git commit -m "Добавлен функционал управления задачами"
~~~

После этого завершаем "фичу" и  объеденяем с основной веткой, с помощью команды `git flow feature finish task-management`.
После этого мы должны автоматически оказаться в ветке develop (что и происходит). Вводим следующие команды 

~~~
git checkout develop
git flow release start v1.0.0
~~~

и начинаем создание релиза.
Создаём файл version.txt и обновляем версию в нём, изпользуя следующие команды 

~~~
echo "v1.0.0" > version.txt
git add version.txt
git commit -m "Обновлена версия для релиза v1.0.0"
~~~

После этого можно завершить релиз командой `git flow release finish v1.0.0` и объкдкняем его с основной веткой.

Создадим хотфикс

~~~
git flow hotfix start hotfix-1.0.1
~~~

Внесём изменения и коммитим

~~~
git add file_with_error.py
git commit -m "Исправлена критическая ошибка"
~~~

Соответсвенно завершаем работу hotfix-1.0.1 и объеденяем с основной веткой

~~~
git flow hotfix finish hotfix-1.0.1
~~~

В конце завершаем работы и отравляем изменения на наш репозиторий.

~~~
git push origin develop
git push origin main
~~~
